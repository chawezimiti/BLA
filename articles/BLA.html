<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BLA">
<title>Boundary Line Analysis • BLA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Boundary Line Analysis">
<meta property="og:description" content="BLA">
<meta property="og:image" content="https://chawezimiti.github.io/BLA/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BLA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/BLA.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Censored_bivariate_normal_model.html">Use of censored bivariate normal model function for yield gap analysis</a>
    <a class="dropdown-item" href="../articles/Introduction_to_BLA.html">Introduction to boundary line analysis</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="dropdown-item" href="https://chawezimiti.github.io/BLA_blog/">Introducing BLA R package </a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chawezimiti/BLA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/ChaweziMiti" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/chawezi-miti-051077b8/" aria-label="LinkedIn">
    <span class="fa fa-linkedin"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Boundary Line Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/chawezimiti/BLA/blob/HEAD/vignettes/BLA.Rmd" class="external-link"><code>vignettes/BLA.Rmd</code></a></small>
      <div class="d-none name"><code>BLA.Rmd</code></div>
    </div>

    
    
<p>This Vignette describe the theory of boundary line analysis and the
process fitting the boundary line to a data set.</p>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>When a biological response, <em><code>y</code></em>, is observed as
function of a single factor of interest, <em><code>x</code></em>, in an
uncontrolled environment i.e. when the influence of other factors is not
controlled, a scatter of observations is observed due to the many
sources of variation. If, for example, <em><code>x</code></em> along
with other factors contributes in some additive way to variation of
<em><code>y</code></em> then then a bivariate normal distribution may be
expected. However, more complex effects are possible. For example, if
the data set is large enough to contain a wide range of combinations of
conditions, and x and other factors influence y in accordance with some
non-linear process as characterized by the law of the minimum, or the
law of the optimum (see Miti <em>et al</em>, 2024a), then the data
points that are observed in most favourable conditions for the response
<em><code>y</code></em> will fall at the upper edges of the data cloud,
which would be the maximum possible response of <em><code>y</code></em>
given some value of <em><code>x</code></em>. The data points that fall
below the maximum response are as a result of the limiting effect of
other factors that are not controlled for. Webb (1972) suggested a
methodology that can be used to describe the relationship of data points
at the upper edges of such data sets which is the most likely
relationship of <em><code>y</code></em> and <em><code>x</code></em> when
all other factors are not limiting. He referred to this relationship as
the boundary line.</p>
<p>The initial boundary line method by Webb (1972) involved the
selection of data points at the upper edges of the data cloud visually.
The boundary line model was then fitted to the selected data points to
describe the relationship. Currently, many other procedures of fitting
the boundary line model to the dataset have been developed to improve
the procedure some of which are statistical and some heuristic. These
include binning, BOLIDES, quantile regression, makowski quantile
regression and the censored bivariate normal methods. Similarly, data
exploratory methods have been developed that provide evidence of
boundary existence in a dataset which therefore, justifies the use of
boundary line analysis on a data set (Milne <em>et al</em>. 2006).
Colleagues of Webb (1972), who provided the initial data on which
boundary line analysis was first applied, were not convinced that the
data realized a boundary, hence the need for testing of data sets for
presence of boundary. If a boundary exists in data set, it is expected
that the distribution of points at the upper edges of data cloud would
be clustered and not randomly distributed because response can not go
beyond the observed boundary. Evidence for such a distribution provides
grounds for proceeding to a boundary line analysis, and Miti <em>et
al</em>. (2024b) describe the method which this package provides to
evaluate this evidence. It should be noted that more powerful testing
against an alternative bivariate normal distribution can be done after
fitting a boundary line model with the <code><a href="../reference/cbvn.html">cbvn()</a></code> function.</p>
<p>The <code>BLA</code> package provides a group of functions to
carryout boundary line analysis on a data set in <code>R</code>
software. It includes functions to explore data, test evidence of
boundary in a data set, fit the boundary line and do post-hoc analysis
after fitting a boundary line.</p>
</div>
<div class="section level2">
<h2 id="boundary-line-analysis-using-bla-package">Boundary line analysis using BLA package<a class="anchor" aria-label="anchor" href="#boundary-line-analysis-using-bla-package"></a>
</h2>
<div class="section level3">
<h3 id="load-the-bla-package">Load the BLA package<a class="anchor" aria-label="anchor" href="#load-the-bla-package"></a>
</h3>
<p>With the <code>BLA</code> package installed, the first step is to
load it to your R session using the <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> command.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://chawezimiti.github.io/BLA/">BLA</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.uni-bielefeld.de/fakultaeten/wirtschaftswissenschaften/fakultaet/lehrende-ehemalige/pwolf/wolf_aplpack/index.xml" class="external-link">aplpack</a></span><span class="op">)</span></span></code></pre></div>
<p>The package <code>aplpack</code> has also been loaded for use in the
outlier detection function <code>bagplot()</code>.</p>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>The <code>BLA</code> package contains a data set called soil which
consisting of soil pH, phosphorus and wheat yield measurements from
farms in the UK. We will use this data set to illustrate the functions
in the <code>BLA</code> package. To view the first six lines of the
data, run the code below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span></span>
<span><span class="co">#&gt;      yield   pH  P</span></span>
<span><span class="co">#&gt; 1  9.55787 6.66 10</span></span>
<span><span class="co">#&gt; 2  8.88999 6.92  9</span></span>
<span><span class="co">#&gt; 3  8.38731 6.83 10</span></span>
<span><span class="co">#&gt; 4  9.19583 6.34  9</span></span>
<span><span class="co">#&gt; 5  9.83057 6.74  9</span></span>
<span><span class="co">#&gt; 6 11.88140 6.54 12</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exploratory-analysis">Exploratory analysis<a class="anchor" aria-label="anchor" href="#exploratory-analysis"></a>
</h3>
<p>An exploratory analysis is an important initial step in boundary line
analysis. This step serves to show how the data are distributed using
various indices and also to check for outliers in the data set. If a
variable in a dataset is skewed, especially the independent variable, a
transformation may be required so it can be assumed to be from a normal
distribution. As the boundary line analysis is sensitive to outlying
values, these must be identified and removed if required. Under the
boundary line model we may expect to see non-normal variation of the
response variable, in this case P, possibly with an increased density at
the upper bound but the rest of the data points must appear as plausibly
drawn from a normal distribution. Exploratory analysis, particularly
using plots, and robust statistics such as the octile skewness, provides
a basis to assess the plausibility of an underlying normal variable,
perhaps with a censoring effect and whether a transformation is needed,
as well as the form of model that can be fitted.</p>
<div class="section level4">
<h4 id="normality-test">Normality test<a class="anchor" aria-label="anchor" href="#normality-test"></a>
</h4>
<p>To assess the distribution of the data, the <code><a href="../reference/summastat.html">summastat()</a></code>
function provides different summary statistics and the graphical
representation of the variable distribution. Let us set the variables P
and wheat yield in the data set to <em><code>x</code></em> and
<em><code>y</code></em> respectively before applying the
<code><a href="../reference/summastat.html">summastat()</a></code> functions</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">&lt;-</span><span class="va">soil</span><span class="op">$</span><span class="va">P</span></span>
<span><span class="va">y</span><span class="op">&lt;-</span><span class="va">soil</span><span class="op">$</span><span class="va">yield</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summastat.html">summastat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt;         Mean Median Quartile.1 Quartile.3 Variance       SD Skewness</span></span>
<span><span class="co">#&gt; [1,] 25.9647     22         16         32 207.0066 14.38772 1.840844</span></span>
<span><span class="co">#&gt;      Octile skewness Kurtosis No. outliers</span></span>
<span><span class="co">#&gt; [1,]       0.3571429 5.765138           43</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/summastat.html">summastat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-6-2.png" width="384" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt;          Mean  Median Quartile.1 Quartile.3 Variance       SD   Skewness</span></span>
<span><span class="co">#&gt; [1,] 9.254813 9.36468   8.203703   10.39477 3.456026 1.859039 -0.4819805</span></span>
<span><span class="co">#&gt;      Octile skewness Kurtosis No. outliers</span></span>
<span><span class="co">#&gt; [1,]     -0.05793291 1.292635            7</span></span></code></pre>
<p>From the results, wheat yield (<em><code>y</code></em>) variables can
be considered to be normally distributed while the soil P
(<em><code>x</code></em>) is skewed. For a variable to be assumed to be
from a normal distribution, the indices skewness should be between -1 to
1 and Octile skewness between -0.2 to 0.2. A graphical representation of
the distribution is given as well.</p>
<p>The soil P can be log transformed and check the summary statistics
and plot</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summastat.html">summastat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-7-1.png" width="384" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt;          Mean   Median Quartile.1 Quartile.3  Variance        SD  Skewness</span></span>
<span><span class="co">#&gt; [1,] 3.126361 3.091042   2.772589   3.465736 0.2556936 0.5056615 0.1297406</span></span>
<span><span class="co">#&gt;      Octile skewness    Kurtosis No. outliers</span></span>
<span><span class="co">#&gt; [1,]      0.08395839 -0.05372586            0</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># transforms soil P to log </span></span></code></pre></div>
<p>From the results, variable log of soil P can be assumed to be from a
normal distribution.</p>
</div>
<div class="section level4">
<h4 id="outlier-detection-and-removal">Outlier detection and removal<a class="anchor" aria-label="anchor" href="#outlier-detection-and-removal"></a>
</h4>
<p>Outliers are identified using the bagplot method (Rousseeuw <em>et
al</em>., 1999). A bag plot is a multivariate equivalent of a box plot.
We utilise the <code>bagplop()</code> function from the
<code>aplpack</code> package to produce bagplots.The bagplot has three
main components. There are</p>
<ol style="list-style-type: decimal">
<li><p><strong>depth median</strong> which represent the center of the
data cloud. This is equivalent to the median in a univariate
box-plot</p></li>
<li><p><strong>Bag</strong> which contains 50% of all the data points.
This is equivalent to the inter-quartile range in a univariate
box-plot.</p></li>
<li><p><strong>Loop</strong> which contains all points that are outside
the bag but are not outliers</p></li>
<li><p><strong>Outliers</strong> which are values outside the
loop</p></li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">vals_ur</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span> <span class="co">#Create a matrix with x and y as required by the bag plot function</span></span>
<span><span class="va">vals_ur</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x</span> </span>
<span><span class="va">vals_ur</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">y</span></span>
<span></span>
<span><span class="va">bag</span><span class="op">&lt;-</span><span class="fu">bagplot</span><span class="op">(</span><span class="va">vals_ur</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span><span class="op">)</span>, show.whiskers <span class="op">=</span><span class="cn">F</span>,create.plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># run the bagplot function</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bag"</span>,<span class="st">"loop"</span>,<span class="st">"outliers"</span>, <span class="st">"d.median"</span><span class="op">)</span>,</span>
<span>        pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">15</span>,<span class="fl">16</span>,<span class="fl">8</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"lightblue"</span>,<span class="st">"red"</span>,<span class="st">"red"</span><span class="op">)</span>,</span>
<span>       cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vals</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">bag</span><span class="op">$</span><span class="va">pxy.bag</span>,<span class="va">bag</span><span class="op">$</span><span class="va">pxy.outer</span><span class="op">)</span> <span class="co"># to remove outliers, select points in the bag and loop only</span></span></code></pre></div>
<p>The variables <em><code>x</code></em> and <em><code>y</code></em> and
now be extracted from the results of the bag plot with outliers
removed</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">&lt;-</span><span class="va">vals</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">y</span><span class="op">&lt;-</span><span class="va">vals</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="test-for-presence-of-boundary-in-dataset">Test for presence of boundary in dataset<a class="anchor" aria-label="anchor" href="#test-for-presence-of-boundary-in-dataset"></a>
</h4>
<p>The function <code>exp_boundary()</code> can be used to evaluate
evidence that observations are clustered near an upper boundary in a
data set, testing this against an unbounded bivariate normal
distribution as a null hypothesis. The standard deviation (<em>sd</em>)
of the the Euclidean distance of the boundary points to the centre of
the data set is used to measure the density of the points at the upper
edges of the data. The smaller the <em>sd</em> value, the denser the
distribution. This function uses the convex hull to select the points at
the upper boundary. The default is selecting the first 10 consecutive
convex hulls (<code>shells=10</code>). The convex hulls are then splits
into two sections, the right and left sections, and evidence of boundary
existence in both sections is checked by determining the probability of
having the observed density of points at the upper edges of the data
under the bivariate normal null hypothesis. More detail is provided by
Miti <em>et al</em>. 2024b. We reject the null hypothesis if p&lt;
0.05.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bound_test</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/expl_boundary.html">expl_boundary</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,shells <span class="op">=</span> <span class="fl">10</span>, simulations <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                          pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="co"># </span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">bound_test</span></span>
<span><span class="co">#&gt;     Index Section    value</span></span>
<span><span class="co">#&gt; 1      sd    Left 1.045711</span></span>
<span><span class="co">#&gt; 2      sd   Right 1.115379</span></span>
<span><span class="co">#&gt; 3 Mean sd    Left 1.134728</span></span>
<span><span class="co">#&gt; 4 Mean sd   Right 1.200326</span></span>
<span><span class="co">#&gt; 5 p_value    Left 0.030000</span></span>
<span><span class="co">#&gt; 6 p_value   Right 0.020000</span></span></code></pre></div>
<p>The p-values in the left and right sections are both less than 0.05.
These results indicate evidence of an upper boundary in both the left
and right sections of the scatter. This suggests that there is a
justification to fitting the boundary to the data. A graphical
representation of the scatter plot with the boundary points is also
given as well as the density histograms showing the observed standard
deviation given 10000 simulated standard deviations from normal
unbounded data .</p>
</div>
</div>
<div class="section level3">
<h3 id="fitting-boundary-line-using-different-methods">Fitting boundary line using different methods<a class="anchor" aria-label="anchor" href="#fitting-boundary-line-using-different-methods"></a>
</h3>
<p>The exploratory tests indicated that the data provides evidence of an
upper boundary, there are no outliers and the variables,
<em><code>x</code></em> and <em><code>y</code></em>, appear normally
distributed. We therefore, proceed to fit a boundary line model to the
data set. There are several methods that can be used to fit a boundary
line to the data set which can be classified as heuristic (Bolides,
Binning &amp; quantile regression) and statistical methods (censored
bivariate normal). Miti <em>et al.</em> (2024a) give more detail on each
of these methods.</p>
<div class="section level4">
<h4 id="bolides-algorithm">Bolides algorithm<a class="anchor" aria-label="anchor" href="#bolides-algorithm"></a>
</h4>
<p>This method fit the boundary line following the boundary line
determination technique proposed by Schnug <em>et al.</em> (1995). To
fit the boundary line using the BOLIDES algorithm , the
<code><a href="../reference/BOLIDES.html">bolides()</a></code> function can be used. To check the required
arguments for the function, the help page can be launched.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">bolides</span></span></code></pre></div>
<p>The arguments <em><code>x</code></em> and <em><code>y</code></em> are
the independent and dependent variable respectively and
<code>start</code> is a vector of starting values . The
<code>model</code> argument is used to specify the model of the boundary
line e.g. “blm” for the linear model. The <code>xmax</code> is an
argument that describes the maximum value of the independent variable
beyond which the relation of <em><code>x</code></em> and
<em><code>y</code></em> is no longer theoretically feasible. Other
arguments relate to the plot parameters as in the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function.</p>
<p>All boundary fitting methods require initial starting values for the
parameters of a proposed model. The initial starting values are
optimized to find the parameters of the proposed model as in the
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> function in base <code>R</code>.</p>
<p>To get the start starting values, the <code><a href="../reference/BOLIDES.html">bolides()</a></code> function
is run with the argument <code>model="explore"</code>. This allows us to
view the selected boundary points using the boundary line determination
technique.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BOLIDES.html">bolides</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,model <span class="op">=</span> <span class="st">"explore"</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-13-1.png" width="384" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt;        x               y         </span></span>
<span><span class="co">#&gt;  Min.   :1.609   Min.   : 7.513  </span></span>
<span><span class="co">#&gt;  1st Qu.:2.583   1st Qu.:10.817  </span></span>
<span><span class="co">#&gt;  Median :3.649   Median :12.566  </span></span>
<span><span class="co">#&gt;  Mean   :3.464   Mean   :11.965  </span></span>
<span><span class="co">#&gt;  3rd Qu.:4.520   3rd Qu.:13.575  </span></span>
<span><span class="co">#&gt;  Max.   :4.736   Max.   :14.159</span></span></code></pre>
<p>From the plot, it can be seen that a “trapezium” model will be more
appropriate for this data set. The function <code><a href="../reference/startValues.html">startValues()</a></code>
can be used to determine initial start values. For more information on
<code><a href="../reference/startValues.html">startValues()</a></code> function see <code>?startValues()</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="fu"><a href="../reference/startValues.html">startValues</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>With a scatter plot of <em><code>y</code></em> against
<em><code>x</code></em> active in the plot window in <code>R</code>, run
the function <code>startValues("trapezium")</code>, then use the mouse
to click on the plot at five boundary points that follow the trapezium
model in order of increasing <em><code>x</code></em> values.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/startValues.html">startValues</a></span><span class="op">(</span><span class="st">"trapezium"</span><span class="op">)</span> <span class="co"># then select the five points at the edge of the dataset that make up the trapezium model in order of increasing x values.</span></span></code></pre></div>
<p>The proposed start values will be produced. Note that this can be
done for other models as well. Once all the arguments are set, the
function can be run</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">14</span>,<span class="fl">104</span>,<span class="op">-</span><span class="fl">22</span><span class="op">)</span> <span class="co"># start values is a vector of five consists of intercept, slope, plateau yield, intercept2 and slope2. </span></span>
<span></span>
<span><span class="va">model1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/BOLIDES.html">bolides</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, start <span class="op">=</span> <span class="va">start</span>,model <span class="op">=</span> <span class="st">"trapezium"</span>,</span>
<span>                xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Phosphorus/ln(mg L"</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>, </span>
<span>                ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Yield/ t ha"</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">16</span>, </span>
<span>                col<span class="op">=</span><span class="st">"grey"</span>, bp_col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-16-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model1</span></span>
<span><span class="co">#&gt; $Model</span></span>
<span><span class="co">#&gt; [1] "trapezium"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Equation</span></span>
<span><span class="co">#&gt; [1] y = min(β₁ + β₂x, β₀, β₃ + β₄x)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Parameters</span></span>
<span><span class="co">#&gt;      Estimate</span></span>
<span><span class="co">#&gt; β₁   4.765511</span></span>
<span><span class="co">#&gt; β₂   3.456652</span></span>
<span><span class="co">#&gt; β₀  13.573119</span></span>
<span><span class="co">#&gt; β₃ 108.346207</span></span>
<span><span class="co">#&gt; β₄ -21.263562</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $RMS</span></span>
<span><span class="co">#&gt; [1] 0.2174186</span></span></code></pre></div>
<p>The results show that the optimized parameters and plot of the fitted
model. There is no uncertainty in the parameters because this is a
heuristic method.</p>
<p>These parameters can then be used to determine boundary line response
for any given value of <em><code>x</code></em>. Say you want to predict
the maximum possible yield response at soil P values of 4.5, 7.4, 12.2,
20.1 and 54.5 mg/kg. Remember that our model was fitted on values of log
soil P and therefore, these values must first be log transformed before
the prediction is made. We can use the function <code><a href="../reference/predictBL.html">predictBL()</a></code>
for this purpose. For more information on this function, see
<code>?predictBL()</code> .</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">P</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">7.4</span>, <span class="fl">12.2</span>, <span class="fl">20.1</span>, <span class="fl">54.5</span><span class="op">)</span></span>
<span><span class="va">P_log</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Max_Response</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/predictBL.html">predictBL</a></span><span class="op">(</span><span class="va">model1</span>, <span class="va">P_log</span><span class="op">)</span> <span class="co"># the argument inputs are the boundary line model and the independent values (in this case P_log)</span></span>
<span></span>
<span><span class="va">Max_Response</span></span>
<span><span class="co">#&gt; [1]  9.964583 11.683930 13.412104 13.573119 13.573119</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="binning-method">Binning method<a class="anchor" aria-label="anchor" href="#binning-method"></a>
</h4>
<p>The binning methodology involves splitting the data into several
sections in the x-axis and selecting a boundary point in each section
based on a set criteria (mostly the 95<span class="math inline">\(^{\rm
th}\)</span> and 99<span class="math inline">\(^{\rm th}\)</span>
percentile) (Shatar and McBratney, 2004). To fit the boundary line using
the binning method, the <code><a href="../reference/blbin.html">blbin()</a></code> function can be used. To
check the required arguments for the function, the help page can be
launched.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">blbin</span></span></code></pre></div>
<p>The arguments <em><code>x</code></em> and <em><code>y</code></em> are
the independent and dependent variable respectively and
<code>start</code> is a vector of starting values . The
<code>model</code> argument is used to specify the model of the boundary
line e.g. <code>model="blm"</code> for the linear model. The
<code>bins</code> argument describes the size of the bins with a vector
of length 3 containing the minimum and maximum independent variable
values, and the size of bins to be used for the data respectively. We
assume that the 99<span class="math inline">\(^{\rm th}\)</span>
percentile (<code>tau=0.99</code>) is the boundary.</p>
<p>The initial start start values can be determined as previously shown
in the previous section</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bins</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.61</span>,<span class="fl">4.74</span>,<span class="fl">0.313</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="../reference/blbin.html">blbin</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, <span class="va">bins</span>,model <span class="op">=</span> <span class="st">"explore"</span>, tau<span class="op">=</span><span class="fl">0.99</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-19-1.png" width="384" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt;        x               y        </span></span>
<span><span class="co">#&gt;  Min.   :1.792   Min.   :10.71  </span></span>
<span><span class="co">#&gt;  1st Qu.:2.487   1st Qu.:11.98  </span></span>
<span><span class="co">#&gt;  Median :3.162   Median :12.83  </span></span>
<span><span class="co">#&gt;  Mean   :3.175   Mean   :12.55  </span></span>
<span><span class="co">#&gt;  3rd Qu.:3.862   3rd Qu.:13.34  </span></span>
<span><span class="co">#&gt;  Max.   :4.591   Max.   :13.37</span></span></code></pre>
<p>From the plot, it can be seen that a “trapezium” model will be more
appropriate for this data set.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/startValues.html">startValues</a></span><span class="op">(</span><span class="st">"trapezium"</span><span class="op">)</span></span></code></pre></div>
<p>The values for <code>start</code> can now be obtained and the
function can now be run.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.75</span>, <span class="fl">3.23</span>, <span class="fl">13.3</span>, <span class="fl">24.87</span>,<span class="op">-</span><span class="fl">2.95</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">model2</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/blbin.html">blbin</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, <span class="va">bins</span>,start <span class="op">=</span> <span class="va">start</span>,model <span class="op">=</span> <span class="st">"trapezium"</span>, </span>
<span>              tau<span class="op">=</span><span class="fl">0.99</span>, </span>
<span>              ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"t ha"</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>              xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Phosphorus/ln(mg L"</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>, </span>
<span>              pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">"grey"</span>, bp_col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-21-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model2</span></span>
<span><span class="co">#&gt; $Model</span></span>
<span><span class="co">#&gt; [1] "trapezium"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Equation</span></span>
<span><span class="co">#&gt; [1] y = min(β₁+ β₂x, β₀, β₃ + β₄x)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Parameters</span></span>
<span><span class="co">#&gt;     Estimate</span></span>
<span><span class="co">#&gt; β₁  4.595981</span></span>
<span><span class="co">#&gt; β₂  3.409921</span></span>
<span><span class="co">#&gt; β₀ 13.342115</span></span>
<span><span class="co">#&gt; β₃ 21.883246</span></span>
<span><span class="co">#&gt; β₄ -2.262389</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $RMS</span></span>
<span><span class="co">#&gt; [1] 0.01027899</span></span></code></pre></div>
<p>The results show that the optimized parameters and plot. There is no
uncertainty in the parameters because this is a heuristic method. These
parameters can then be used to determine boundary line response for any
given value of <em><code>x</code></em> using the
<code><a href="../reference/predictBL.html">predictBL()</a></code> function.</p>
</div>
<div class="section level4">
<h4 id="quantile-regression-method">Quantile regression method<a class="anchor" aria-label="anchor" href="#quantile-regression-method"></a>
</h4>
<p>This method fits the boundary line using the principle of quantile
regression (Cade and Noon, 2003). To fit the boundary line using the
quantile regression method, the <code><a href="../reference/blqr.html">blqr()</a></code> function can be
used. To check the required arguments for the function, the help page
can be launched.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">blqr</span></span></code></pre></div>
<p>The arguments <em><code>x</code></em> and <em><code>y</code></em> are
the independent and dependent variable respectively and
<code>start</code> is a vector of starting values . The
<code>model</code> argument is used to specify the model of the boundary
line e.g. “blm” for the linear model. The argument <code>tau</code>
describes the quantile value described as boundary. We assume that the
99<span class="math inline">\(^{\rm th}\)</span> quantile
(<code>tau=0.99</code>) value is the boundary. This is an arbitrary
assumption, and for this reason we treat the method as heuristic.</p>
<p>The initial start start values can be determined as previously shown
in the previous section. however, the <code><a href="../reference/blqr.html">blqr()</a></code> function does
not have the explore option and hence the <code><a href="../reference/startValues.html">startValues()</a></code>
function is used just on the plot of <em><code>x</code></em> and
<em><code>y</code></em> directly according to the suggested model from
the structure at the upper edge of the data. The trapezium model will be
used for this data.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/startValues.html">startValues</a></span><span class="op">(</span><span class="st">"trapezium"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>start</code>values can now be used in the
<code><a href="../reference/blqr.html">blqr()</a></code> function.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">13.5</span>,<span class="fl">31</span>,<span class="op">-</span><span class="fl">4.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model3</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/blqr.html">blqr</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, start <span class="op">=</span> <span class="va">start</span>, model <span class="op">=</span> <span class="st">"trapezium"</span>,</span>
<span>             xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Phosphorus/ mg L"</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>             ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Phosphorus/ln(mg L"</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>             pch<span class="op">=</span><span class="fl">16</span>,tau<span class="op">=</span><span class="fl">0.99</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="co"># may take a few seconds to ran</span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-24-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model3</span></span>
<span><span class="co">#&gt; $Model</span></span>
<span><span class="co">#&gt; [1] "trapezium"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Equation</span></span>
<span><span class="co">#&gt; [1] y = min(β₁ + β₂x, β₀, β₃ + β₄x)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Parameters</span></span>
<span><span class="co">#&gt;     Estimate</span></span>
<span><span class="co">#&gt; β₁  7.559968</span></span>
<span><span class="co">#&gt; β₂  2.142848</span></span>
<span><span class="co">#&gt; β₀ 13.363650</span></span>
<span><span class="co">#&gt; β₃ 30.667717</span></span>
<span><span class="co">#&gt; β₄ -4.192797</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $RSS</span></span>
<span><span class="co">#&gt; [1] 252.7349</span></span></code></pre></div>
<p>The results show that the optimized parameters and plot. The quantile
regression method will produce measures of uncertainty for parameters,
but BLA does not report these because they are conditional on the
arbitrary choice of <code>tau</code>. These parameters can then be used
to determine boundary line response for any given value of
<em><code>x</code></em> using the <code><a href="../reference/predictBL.html">predictBL()</a></code> function.</p>
</div>
<div class="section level4">
<h4 id="censored-bivariate-normal-model">Censored bivariate normal model<a class="anchor" aria-label="anchor" href="#censored-bivariate-normal-model"></a>
</h4>
<p>To fit the boundary line using the Censored bivariate normal model
method, see the
<code><a href="../articles/Censored_bivariate_normal_model.html">vignette("Censored_bivariate_normal_model")</a></code>.</p>
</div>
<div class="section level4">
<h4 id="using-your-own-defined-model">Using your own defined model<a class="anchor" aria-label="anchor" href="#using-your-own-defined-model"></a>
</h4>
<p>The illustrated methods for fitting the boundary line have some
in-built models. These include the linear, linear plateau, mitscherlich,
schmidt, logistic, logistic model proposed by Nelder (1961), the inverse
logistic, double logistic, quadratic and the trapezium models. However,
there are some cases where one wants to fit another model which is not
part of the built in models. The following steps will illustrate how to
fit a custom model. Though this will be illustrated using the
<code><a href="../reference/BOLIDES.html">bolides()</a></code> function, it also applies for the
<code><a href="../reference/blbin.html">blbin()</a></code>, <code><a href="../reference/blqr.html">blqr()</a></code> and <code><a href="../reference/cbvn.html">cbvn()</a></code>
functions.</p>
<p>Assuming that the initial data exploratory step have been done, the
first step is to check the structure of the boundary points using the
argument <code>model="explore"</code> in the <code><a href="../reference/BOLIDES.html">bolides()</a></code>
function.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BOLIDES.html">bolides</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,model<span class="op">=</span><span class="st">"explore"</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-25-1.png" width="384" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt;        x               y         </span></span>
<span><span class="co">#&gt;  Min.   :1.609   Min.   : 7.513  </span></span>
<span><span class="co">#&gt;  1st Qu.:2.583   1st Qu.:10.817  </span></span>
<span><span class="co">#&gt;  Median :3.649   Median :12.566  </span></span>
<span><span class="co">#&gt;  Mean   :3.464   Mean   :11.965  </span></span>
<span><span class="co">#&gt;  3rd Qu.:4.520   3rd Qu.:13.575  </span></span>
<span><span class="co">#&gt;  Max.   :4.736   Max.   :14.159</span></span></code></pre>
<p>Lets say you want to fit a model</p>
<p><span class="math display">\[
y=\beta_0 - \beta_1(x-\beta_2)^2
\]</span></p>
<p>The model is written in form of an <code>R</code> function and the
parameters should always be written in alphabetical order as
<em><strong>a</strong>, <strong>b</strong></em> and
<strong><em>c</em></strong> for a three parameter function,
<em><strong>a</strong>, <strong>b</strong>,<strong>c</strong></em> and
<strong><em>d</em></strong> for four parameter function and so on.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custom_function</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">a</span>,<span class="va">b</span>,<span class="va">c</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">y</span><span class="op">&lt;-</span> <span class="va">a</span> <span class="op">-</span> <span class="va">b</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">c</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The next step is to suggest the initial start <code>start</code>
values. These should be sensible values else the function will not
converge. These should be arranges in alphabetical order as
<code>start=c(a,b,c)</code>. Replace a, b and c with numeric values of
your choice.</p>
<p>The arguments of <code><a href="../reference/BOLIDES.html">bolides()</a></code> function can now be added. In
this case, the argument model while be set to “other”. The arguments
equation is now set to your custom function
(<code>equation=custom_function</code>)</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13.5</span>,<span class="fl">3</span>,<span class="fl">3.3</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">model4</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/BOLIDES.html">bolides</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, start <span class="op">=</span> <span class="va">start</span>,model <span class="op">=</span> <span class="st">"other"</span>,</span>
<span>                equation<span class="op">=</span><span class="va">custom_function</span>,</span>
<span>                xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Phosphorus/mg L"</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Phosphorus/ln(mg L"</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>, </span>
<span>                pch<span class="op">=</span><span class="fl">16</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.8</span>,<span class="fl">14.5</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"grey"</span>,bp_col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BLA_files/figure-html/unnamed-chunk-27-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model4</span></span>
<span><span class="co">#&gt; $Model</span></span>
<span><span class="co">#&gt; [1] "other"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Equation</span></span>
<span><span class="co">#&gt; function(x,a,b,c){</span></span>
<span><span class="co">#&gt;   y&lt;- a - b*(x-c)^2</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x55763d1489a0&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Parameters</span></span>
<span><span class="co">#&gt;    Estimate</span></span>
<span><span class="co">#&gt; a 14.498417</span></span>
<span><span class="co">#&gt; b  2.175998</span></span>
<span><span class="co">#&gt; c  3.128628</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $RMS</span></span>
<span><span class="co">#&gt; [1] 0.5166668</span></span></code></pre></div>
<p>The parameters of the models are shown in the results. A prediction
of the boundary response values for each value of
<em><code>x</code></em> can the be done as previously shown using the
<code><a href="../reference/predictBL.html">predictBL()</a></code> function.</p>
</div>
</div>
<div class="section level3">
<h3 id="closing-remarks">Closing remarks<a class="anchor" aria-label="anchor" href="#closing-remarks"></a>
</h3>
<p>The boundary line fitting methods illustrated here all use the
optimization function to determine the parameters of the proposed
models. To remove the risk of local optimum parameters, it is advised
that the models are ran on several starting values and the results with
the smallest error can be selected. Each method produces the error value
in the output. It is residue mean square (RMS) for <code><a href="../reference/blbin.html">blbin()</a></code>
and <code><a href="../reference/BOLIDES.html">bolides()</a></code> while <code><a href="../reference/blqr.html">blqr()</a></code> it is the residue
sum squares (RSS). For the <code><a href="../reference/cbvn.html">cbvn()</a></code>, use the likelihood
value.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Cade, B. S., &amp; Noon, B. R. (2003). A gentle introduction to
quantile regression for ecologists. Frontiers in Ecology and the
Environment, 1(8), 412-420. <a href="https://doi.org/10.1890/1540-9295(2003)001%5B0412:AGITQR%5D2.0.CO;2" class="external-link uri">https://doi.org/10.1890/1540-9295(2003)001[0412:AGITQR]2.0.CO;2</a></p></li>
<li><p>Lark, R. M., Gillingham, V., Langton, D., &amp; Marchant, B. P.
(2020). Boundary line models for soil nutrient concentrations and wheat
yield in national-scale datasets. European Journal of Soil Science, 71 ,
334-351. <a href="https://doi.org/10.1111/ejss.12891" class="external-link uri">https://doi.org/10.1111/ejss.12891</a></p></li>
<li><p>Milne, A. E., Wheeler, H. C., &amp; Lark, R. M. (2006). On
testing biological data for the presence of a boundary. Annals of
Applied Biology, 149 , 213-222. <a href="https://doi.org/10.1111/j.1744-7348.2006.00085.x" class="external-link uri">https://doi.org/10.1111/j.1744-7348.2006.00085.x</a></p></li>
<li><p>Miti, C., Milne, A., Giller, K., Sadras, V., &amp; Lark, R.
(2024). Exploration of data for analysis using boundary line
methodology. Computers and Electronics in Agriculture, 219. <a href="https://doi.org/10.1016/j.compag.2024.108794" class="external-link uri">https://doi.org/10.1016/j.compag.2024.108794</a></p></li>
<li><p>Miti, C., Milne, A., Giller, K., &amp; Lark, R. (2024). The
concepts and quantification of yield gap using boundary lines. a review.
Field Crops Research, 311. <a href="https://doi.org/10.1016/j.fcr.2024.109365" class="external-link uri">https://doi.org/10.1016/j.fcr.2024.109365</a>.</p></li>
<li><p>Nelder, J.A. 1961. The fitting of a generalization of the
logistic curve. Biometrics 17: 89–110. <a href="https://doi.org/10.2307/2527498" class="external-link uri">https://doi.org/10.2307/2527498</a></p></li>
<li><p>Rousseeuw, P. J., Ruts, I., &amp; Tukey, J. W. (1999). The
bagplot: A bivariate boxplot. The American Statistician, 53, 382–387. <a href="https://doi.org/10.1080/00031305.1999.10474494" class="external-link uri">https://doi.org/10.1080/00031305.1999.10474494</a></p></li>
<li><p>Shatar, T. M., &amp; McBratney, A. B. (2004). Boundary-line
analysis of field-scale yield response to soil properties. Journal of
Agricultural Science, 142 , 553-560.</p></li>
<li><p>Schnug, E., Heym, J. M., &amp; Murphy, D. P. L. (1995). Boundary
line determination technique (bolides). In P. C. Robert, R. H. Rust,
&amp; W. E. Larson (Eds.), site specific management for agricultural
systems (p. 899-908). Wiley Online Library. <a href="https://doi.org/10.2134/1995.site-specificmanagement.c66" class="external-link uri">https://doi.org/10.2134/1995.site-specificmanagement.c66</a></p></li>
<li><p>Webb, R. A. (1972). Use of the boundary line in analysis of
biological data. Journal of Horticultural Science, 47, 309–319. <a href="https://doi.org/10.1080/00221589.1972.11514472" class="external-link uri">https://doi.org/10.1080/00221589.1972.11514472</a></p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chawezi Miti, Richard M Lark, Alice E Milne, Ken E Giller, University of Nottingham/Rothamsted Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
